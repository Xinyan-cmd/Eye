function arrayBufferOverflow() {
  let buf = new ArrayBuffer(0x1000);
  let view = new Uint32Array(buf);

  let evil = {
    [Symbol.toPrimitive]() { return 0xffffffff; }
  };

  try {
    view[evil] = 0x41414141; // OOB write
    return view.length > 0x1000/4 ? "VULNERABLE" : "PATCHED";
  } catch(e) {
    return "PATCHED";
  }
}
