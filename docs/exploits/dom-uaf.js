function domUAF() {
  let div = document.createElement("div");
  let weakRef = new WeakRef(div);
  div = null; // Free DOM object

  // Attempt to reuse freed memory
  for (let i = 0; i < 1e5; i++) {
    let x = document.createElement("div");
    if (weakRef.deref() === undefined) continue;
    x.__proto__ = weakRef.deref(); // UAF if object still in memory
    return "VULNERABLE";
  }
  return "PATCHED";
}
